import React, { useState, useEffect } from 'react';
import './dashboard.css';
import DashboardTable from 'components/table/DashboardTable';
import sendRequest from 'js/sendRequest';
import Preloader from 'components/preloader/Preloader';
import SearchChannel from 'components/searchChannel/SearchChannel';
import StreamersContext from 'context/streamersContext';
import splitInto2 from 'js/splitInto2';

// let list = [
//     {"stream":null,"onlineViewers":{"max":"-","middle":"-","inDays":null},"streamsIn7Days":"-","id":"46947742","name":"RIKKIDI","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/46993a9e-557f-4b6b-9703-70ce9338110c-profile_image-300x300.jpg","followers":{"actual":"15 338","diff":"-13","inDays":"за 7 д."},"views":{"actual":"331 717","diff":"+1 043","inDays":"за 26 д."},"isClosed":false,"totalVideos":2},{"stream":{"viewers":"1 026"},"onlineViewers":{"max":"1 216","middle":"470","inDays":"за 14 д."},"streamsIn7Days":10,"id":"32536070","name":"y0nd","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/2ceffe1a-95cd-4928-aa90-d429346ce70c-profile_image-300x300.png","followers":{"actual":"175 848","diff":"+596","inDays":"за 7 д."},"views":{"actual":"14 668 184","diff":"+135 227","inDays":"за 26 д."},"isClosed":false,"totalVideos":44},{"stream":null,"onlineViewers":{"max":"1 073","middle":"425","inDays":"за 14 д."},"streamsIn7Days":5,"id":"63813769","name":"pashadizel","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/4012c5bd-c041-4a66-8da6-99135067f9cd-profile_image-300x300.jpeg","followers":{"actual":"92 690","diff":"-89","inDays":"за 7 д."},"views":{"actual":"5 323 547","diff":"+58 452","inDays":"за 26 д."},"isClosed":false,"totalVideos":29},{"stream":null,"onlineViewers":{"max":"197","middle":"62","inDays":"за 14 д."},"streamsIn7Days":5,"id":"148602448","name":"MissAlina23","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/eb65669c-cad4-4648-8fc7-af8089887136-profile_image-300x300.png","followers":{"actual":"30 903","diff":"+115","inDays":"за 7 д."},"views":{"actual":"1 095 885","diff":"+33 080","inDays":"за 26 д."},"isClosed":false,"totalVideos":0},{"stream":null,"onlineViewers":{"max":"4 651","middle":"718","inDays":"за 14 д."},"streamsIn7Days":14,"id":"44442348","name":"finargot","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/7c89248e-91af-41a1-8209-232343bc0e74-profile_image-300x300.jpg","followers":{"actual":"112 935","diff":"+3 052","inDays":"за 7 д."},"views":{"actual":"4 050 693","diff":"+694 087","inDays":"за 26 д."},"isClosed":false,"totalVideos":230},{"stream":null,"onlineViewers":{"max":"11 608","middle":"7 061","inDays":"за 14 д."},"streamsIn7Days":7,"totalVideos":0,"id":"68950614","name":"ybicanoooobov","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/ybicanoooobov-profile_image-841fca9b492bd5d5-300x300.jpeg","followers":{"actual":"551 598","diff":"+2 003","inDays":"за 7 д."},"views":{"actual":"63 775 394","diff":"+944 886","inDays":"за 26 д."},"isClosed":false},{"stream":null,"onlineViewers":{"max":"16 837","middle":"10 372","inDays":"за 14 д."},"streamsIn7Days":7,"totalVideos":0,"id":"40488774","name":"Stray228","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/stray228-profile_image-ceb0393a88eb8286-300x300.jpeg","followers":{"actual":"837 802","diff":"+5 942","inDays":"за 7 д."},"views":{"actual":"87 217 853","diff":"+2 774 775","inDays":"за 26 д."},"isClosed":false},{"stream":null,"onlineViewers":{"max":"2 678","middle":"1 528","inDays":"за 14 д."},"streamsIn7Days":11,"id":"71558231","name":"qSnake","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/7d5a4932-be42-481c-a47a-4136404f2c54-profile_image-300x300.png","followers":{"actual":"211 693","diff":"+1 040","inDays":"за 7 д."},"views":{"actual":"27 864 742","diff":"+376 374","inDays":"за 26 д."},"isClosed":false,"totalVideos":86},{"stream":null,"onlineViewers":{"max":"1 563","middle":"828","inDays":"за 14 д."},"streamsIn7Days":8,"id":"136398715","name":"Insize","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/41730834-e1f7-4c62-8e29-af9d2a81257f-profile_image-300x300.png","followers":{"actual":"44 782","diff":"+328","inDays":"за 7 д."},"views":{"actual":"4 849 459","diff":"+141 767","inDays":"за 26 д."},"isClosed":false,"totalVideos":39},{"stream":null,"onlineViewers":{"max":"26 958","middle":"11 561","inDays":"за 13 д."},"streamsIn7Days":5,"id":"81623587","name":"GENSYXA","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/4c9fd41e-bea3-4df7-b740-2d36216a555c-profile_image-300x300.jpg","followers":{"actual":"484 047","diff":"+9 828","inDays":"за 7 д."},"views":{"actual":"16 820 371","diff":"+1 524 730","inDays":"за 26 д."},"isClosed":false,"totalVideos":43},{"stream":null,"onlineViewers":{"max":"1 328","middle":"374","inDays":"за 14 д."},"streamsIn7Days":8,"id":"118970121","name":"Denly","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/b3208605-3e0d-40a6-8bed-1e2f9d17303e-profile_image-300x300.png","followers":{"actual":"191 311","diff":"+138","inDays":"за 7 д."},"views":{"actual":"9 191 046","diff":"+552 506","inDays":"за 26 д."},"isClosed":false,"totalVideos":14},{"stream":null,"onlineViewers":{"max":"119 019","middle":"36 238","inDays":"за 12 д."},"streamsIn7Days":6,"id":"86277097","name":"buster","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/96d66837-22f0-4393-89c5-2e5c2408485b-profile_image-300x300.png","followers":{"actual":"1 433 719","diff":"+21 790","inDays":"за 7 д."},"views":{"actual":"54 936 771","diff":"+5 459 329","inDays":"за 26 д."},"isClosed":false,"totalVideos":50},{"stream":null,"onlineViewers":{"max":"2 528","middle":"1 374","inDays":"за 14 д."},"streamsIn7Days":7,"id":"195675197","name":"steel","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/0439cff8-52a5-41c8-ba2d-de5e2c408558-profile_image-300x300.png","followers":{"actual":"112 142","diff":"+372","inDays":"за 7 д."},"views":{"actual":"3 924 907","diff":"+299 511","inDays":"за 26 д."},"isClosed":false,"totalVideos":53},{"stream":null,"onlineViewers":{"max":"2 164","middle":"931","inDays":"за 14 д."},"streamsIn7Days":8,"id":"32184566","name":"rxnexus","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/904ea508-22b6-4678-9f89-17910ede4fd6-profile_image-300x300.jpeg","followers":{"actual":"266 504","diff":"-38","inDays":"за 7 д."},"views":{"actual":"40 281 385","diff":"+272 885","inDays":"за 26 д."},"isClosed":false,"totalVideos":3},{"stream":null,"onlineViewers":{"max":"16 455","middle":"4 836","inDays":"за 14 д."},"streamsIn7Days":8,"id":"188890121","name":"Dmitry_Lixxx","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/02141c8a-a457-4fe7-bfcb-5e0aeb5919d1-profile_image-300x300.png","followers":{"actual":"464 538","diff":"+8 153","inDays":"за 7 д."},"views":{"actual":"14 230 692","diff":"+1 570 290","inDays":"за 26 д."},"isClosed":false,"totalVideos":69},{"stream":null,"onlineViewers":{"max":"3 956","middle":"1 411","inDays":"за 14 д."},"streamsIn7Days":3,"id":"95793204","name":"GN_GG","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/97535086-e449-48b3-8b7c-03956b1eb697-profile_image-300x300.png","followers":{"actual":"100 022","diff":"-16","inDays":"за 7 д."},"views":{"actual":"10 222 809","diff":"+264 989","inDays":"за 26 д."},"isClosed":false,"totalVideos":1},{"stream":null,"onlineViewers":{"max":"3 765","middle":"1 586","inDays":"за 14 д."},"streamsIn7Days":8,"totalVideos":0,"id":"51435464","name":"A1taOda","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/a1taoda-profile_image-6f6d48127dd91d6e-300x300.jpeg","followers":{"actual":"565 549","diff":"+457","inDays":"за 7 д."},"views":{"actual":"58 170 975","diff":"+765 032","inDays":"за 26 д."},"isClosed":false},{"stream":null,"onlineViewers":{"max":"196","middle":"101","inDays":"за 14 д."},"streamsIn7Days":6,"id":"40974672","name":"NekrPain","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/71b5cd7d-fd0f-4db6-8526-49b43e87777f-profile_image-300x300.png","followers":{"actual":"8 570","diff":"-22","inDays":"за 7 д."},"views":{"actual":"476 313","diff":"+10 392","inDays":"за 26 д."},"isClosed":false,"totalVideos":38},{"stream":null,"onlineViewers":{"max":"35 726","middle":"7 774","inDays":"за 14 д."},"streamsIn7Days":5,"totalVideos":0,"id":112619759,"isClosed":true,"name":"modestal","logo":null,"views":{"lastValue":"20 909 227","date":"29.11.2020"},"followers":{"lastValue":"384 929","date":"29.11.2020"}},{"stream":null,"onlineViewers":{"max":"1 174","middle":"444","inDays":"за 13 д."},"streamsIn7Days":2,"id":"63828424","name":"AIMLUL","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/bf433a0e-1edf-483a-8e08-dc42580bbc0b-profile_image-300x300.png","followers":{"actual":"57 290","diff":"-55","inDays":"за 7 д."},"views":{"actual":"3 926 948","diff":"+86 222","inDays":"за 26 д."},"isClosed":false,"totalVideos":2},{"stream":null,"onlineViewers":{"max":"3 344","middle":"1 105","inDays":"за 14 д."},"streamsIn7Days":8,"id":"36948149","name":"TaeRss","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/taerss-profile_image-109c36e6588d742d-300x300.jpeg","followers":{"actual":"111 003","diff":"+144","inDays":"за 7 д."},"views":{"actual":"17 368 861","diff":"+648 077","inDays":"за 26 д."},"isClosed":false,"totalVideos":25},{"stream":{"viewers":"1 506"},"onlineViewers":{"max":"3 332","middle":"1 383","inDays":"за 13 д."},"streamsIn7Days":8,"id":"118263259","name":"CeMka","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/cemka-profile_image-38e81de032c2f9aa-300x300.png","followers":{"actual":"98 642","diff":"+565","inDays":"за 7 д."},"views":{"actual":"16 402 365","diff":"+1 090 477","inDays":"за 26 д."},"isClosed":false,"totalVideos":44},{"stream":null,"onlineViewers":{"max":"3 229","middle":"712","inDays":"за 14 д."},"streamsIn7Days":11,"id":"116780430","name":"Spt083","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/7136d4b3-3295-4f0f-b119-c2d6729173f1-profile_image-300x300.png","followers":{"actual":"231 924","diff":"+4 840","inDays":"за 7 д."},"views":{"actual":"8 704 401","diff":"+288 408","inDays":"за 26 д."},"isClosed":false,"totalVideos":82},{"stream":null,"onlineViewers":{"max":"-","middle":"-","inDays":null},"streamsIn7Days":"-","id":"39176452","name":"XBOCT","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/xboct-profile_image-eed01158eb730339-300x300.jpeg","followers":{"actual":"316 830","diff":"-109","inDays":"за 7 д."},"views":{"actual":"18 093 692","diff":"+2 683","inDays":"за 26 д."},"isClosed":false,"totalVideos":38},{"stream":null,"onlineViewers":{"max":"3 590","middle":"1 898","inDays":"за 11 д."},"streamsIn7Days":6,"id":"265940345","name":"TpaBoMaH","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/509c81ae-7dad-4764-b0f3-e810c3f0bafc-profile_image-300x300.png","followers":{"actual":"170 685","diff":"+1 024","inDays":"за 7 д."},"views":{"actual":"11 586 103","diff":"+548 564","inDays":"за 26 д."},"isClosed":false,"totalVideos":172},{"stream":null,"onlineViewers":{"max":"-","middle":"-","inDays":null},"streamsIn7Days":"-","id":"451634552","name":"egorkreed","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/e01af657-7453-487b-89e8-00e54b241787-profile_image-300x300.png","followers":{"actual":"439 125","diff":"+690","inDays":"за 7 д."},"views":{"actual":"5 658 921","diff":"+22 783","inDays":"за 26 д."},"isClosed":false,"totalVideos":4},{"stream":null,"onlineViewers":{"max":"1 180","middle":"185","inDays":"за 14 д."},"streamsIn7Days":9,"id":"68147611","name":"ksun41k","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/7d9c0f3e-aee7-4738-9826-435f41903503-profile_image-300x300.png","followers":{"actual":"35 259","diff":"+697","inDays":"за 7 д."},"views":{"actual":"3 209 885","diff":"+103 217","inDays":"за 26 д."},"isClosed":false,"totalVideos":20},{"stream":null,"onlineViewers":{"max":"2 315","middle":"979","inDays":"за 14 д."},"streamsIn7Days":9,"id":"62651386","name":"GeneraL_HS_","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/76442814-883b-490e-a2d2-04b277b04d67-profile_image-300x300.png","followers":{"actual":"56 061","diff":"+383","inDays":"за 7 д."},"views":{"actual":"7 087 036","diff":"+795 926","inDays":"за 26 д."},"isClosed":false,"totalVideos":5},{"stream":null,"onlineViewers":{"max":"4 845","middle":"2 585","inDays":"за 14 д."},"streamsIn7Days":7,"id":"230768385","name":"follentass","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/38bfaa2b-b602-42f3-ad81-7934557529f0-profile_image-300x300.png","followers":{"actual":"161 765","diff":"+901","inDays":"за 7 д."},"views":{"actual":"7 480 259","diff":"+395 608","inDays":"за 26 д."},"isClosed":false,"totalVideos":57},{"stream":null,"onlineViewers":{"max":"-","middle":"-","inDays":null},"streamsIn7Days":"-","id":"218598381","name":"SOSEDATEL","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/262fbd6f-4ac7-4d53-ad60-dc4368928462-profile_image-300x300.png","followers":{"actual":"15 383","diff":"-61","inDays":"за 7 д."},"views":{"actual":"333 708","diff":"+412","inDays":"за 26 д."},"isClosed":false,"totalVideos":12},{"stream":null,"onlineViewers":{"max":"-","middle":"-","inDays":null},"streamsIn7Days":"-","id":"593756357","name":"russianminecrafttours","logo":"https://static-cdn.jtvnw.net/user-default-pictures-uv/ebe4cd89-b4f4-4cd9-adac-2f30151b4209-profile_image-300x300.png","followers":{"actual":"19","diff":0,"inDays":6},"views":{"actual":"9 285","diff":"+296","inDays":"за 6 д."},"isClosed":false,"totalVideos":62}
// ];

const Dashboard = () => {
    const [streamers, setStreamers] = useState([]);
    const [loading, setLoading] = useState(false);

    // let testList = () => {
    //     console.log('list', list);
    //     setTimeout(() => {
    //         setStreamers(list);
    //         setLoading(false);
    //     }, 1500);
    // };

    useEffect(() => {
        // setLoading(true);
        // let nowURL = new URL(window.location.href);
        // if (nowURL.hostname === 'localhost') {
        //     console.log ('на localhost');
        //     testList();
        // } else {
            sendRequest('GET', 'https://stat.metacorp.gg/api/streamers')
            .then(dataArr => {
                setStreamers(dataArr);
                setLoading(false);
            });
        // };
    }, [])

    return (
        <StreamersContext.Provider value={{ setStreamers }}>
            <div className="block wideBlock">
                <SearchChannel />
                {loading && <Preloader />}
                {streamers.length !== 0 && (
                    <div className="mainTable">
                        <DashboardTable streamers={splitInto2.getFirstPart(streamers)} border={"border-right"} />
                        <DashboardTable streamers={splitInto2.getSecondPart(streamers)} border={"border-left"} />
                    </div>
                )}
            </div>
        </StreamersContext.Provider>
    );
};

export default Dashboard;