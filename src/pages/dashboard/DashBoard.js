import React, { useState, useEffect } from 'react';
import './dashboard.css';
import DashboardTable from 'components/table/DashboardTable';
import sendRequest from 'js/sendRequest';
// import getList from 'js/getList';
import Preloader from 'components/preloader/Preloader';
import SearchChannel from 'components/searchChannel/SearchChannel';
import StreamersContext from 'context/streamersContext';
import splitInto2 from 'js/splitInto2';

let list = [
    {"stream":null,"onlineViewers":{"max":"-","middle":"-","inDays":null},"id":"46947742","name":"RIKKIDI","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/46993a9e-557f-4b6b-9703-70ce9338110c-profile_image-300x300.jpg","followers":{"actual":"15 337","diff":"-14","inDays":"за 7 д."},"views":{"actual":"331 710","diff":"+1 036","inDays":"за 26 д."},"isClosed":false,"totalVideos":2},{"stream":null,"onlineViewers":{"max":"1 216","middle":"470","inDays":"за 14 д."},"id":"32536070","name":"y0nd","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/2ceffe1a-95cd-4928-aa90-d429346ce70c-profile_image-300x300.png","followers":{"actual":"175 766","diff":"+514","inDays":"за 7 д."},"views":{"actual":"14 658 748","diff":"+125 791","inDays":"за 26 д."},"isClosed":false,"totalVideos":43},{"stream":null,"onlineViewers":{"max":"1 073","middle":"425","inDays":"за 13 д."},"id":"63813769","name":"pashadizel","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/4012c5bd-c041-4a66-8da6-99135067f9cd-profile_image-300x300.jpeg","followers":{"actual":"92 694","diff":"-85","inDays":"за 7 д."},"views":{"actual":"5 323 532","diff":"+58 437","inDays":"за 26 д."},"isClosed":false,"totalVideos":29},{"stream":null,"onlineViewers":{"max":"197","middle":"62","inDays":"за 14 д."},"totalVideos":0,"id":"148602448","name":"MissAlina23","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/eb65669c-cad4-4648-8fc7-af8089887136-profile_image-300x300.png","followers":{"actual":"30 902","diff":"+114","inDays":"за 7 д."},"views":{"actual":"1 095 847","diff":"+33 042","inDays":"за 26 д."},"isClosed":false},{"stream":null,"onlineViewers":{"max":"4 651","middle":null,"inDays":"за 13 д."},"id":"44442348","name":"finargot","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/7c89248e-91af-41a1-8209-232343bc0e74-profile_image-300x300.jpg","followers":{"actual":"112 941","diff":"+3 058","inDays":"за 7 д."},"views":{"actual":"4 050 581","diff":"+693 975","inDays":"за 26 д."},"isClosed":false,"totalVideos":229},{"stream":null,"onlineViewers":{"max":"11 608","middle":"7 061","inDays":"за 14 д."},"id":"68950614","name":"ybicanoooobov","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/ybicanoooobov-profile_image-841fca9b492bd5d5-300x300.jpeg","followers":{"actual":"551 605","diff":"+2 010","inDays":"за 7 д."},"views":{"actual":"63 773 692","diff":"+943 184","inDays":"за 26 д."},"isClosed":false,"totalVideos":0},{"stream":null,"onlineViewers":{"max":"16 837","middle":"10 372","inDays":"за 14 д."},"totalVideos":0,"id":"40488774","name":"Stray228","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/stray228-profile_image-ceb0393a88eb8286-300x300.jpeg","followers":{"actual":"837 751","diff":"+5 891","inDays":"за 7 д."},"views":{"actual":"87 213 478","diff":"+2 770 400","inDays":"за 26 д."},"isClosed":false},{"stream":{"viewers":"2 463"},"onlineViewers":{"max":"2 460","middle":"1 476","inDays":"за 14 д."},"id":"71558231","name":"qSnake","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/7d5a4932-be42-481c-a47a-4136404f2c54-profile_image-300x300.png","followers":{"actual":"211 684","diff":"+1 031","inDays":"за 7 д."},"views":{"actual":"27 862 815","diff":"+374 447","inDays":"за 26 д."},"isClosed":false,"totalVideos":87},{"stream":null,"onlineViewers":{"max":"1 563","middle":"828","inDays":"за 14 д."},"id":"136398715","name":"Insize","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/41730834-e1f7-4c62-8e29-af9d2a81257f-profile_image-300x300.png","followers":{"actual":"44 781","diff":"+327","inDays":"за 7 д."},"views":{"actual":"4 849 237","diff":"+141 545","inDays":"за 26 д."},"isClosed":false,"totalVideos":39},{"stream":null,"onlineViewers":{"max":"26 958","middle":"11 561","inDays":"за 13 д."},"id":"81623587","name":"GENSYXA","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/4c9fd41e-bea3-4df7-b740-2d36216a555c-profile_image-300x300.jpg","followers":{"actual":"483 961","diff":"+9 742","inDays":"за 7 д."},"views":{"actual":"16 819 714","diff":"+1 524 073","inDays":"за 26 д."},"isClosed":false,"totalVideos":43},{"stream":null,"onlineViewers":{"max":"1 328","middle":"374","inDays":"за 14 д."},"id":"118970121","name":"Denly","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/b3208605-3e0d-40a6-8bed-1e2f9d17303e-profile_image-300x300.png","followers":{"actual":"191 315","diff":"+142","inDays":"за 7 д."},"views":{"actual":"9 190 924","diff":"+552 384","inDays":"за 26 д."},"isClosed":false,"totalVideos":14},{"stream":null,"onlineViewers":{"max":"119 019","middle":"36 238","inDays":"за 12 д."},"id":"86277097","name":"buster","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/96d66837-22f0-4393-89c5-2e5c2408485b-profile_image-300x300.png","followers":{"actual":"1 433 227","diff":"+21 298","inDays":"за 7 д."},"views":{"actual":"54 934 566","diff":"+5 457 124","inDays":"за 26 д."},"isClosed":false,"totalVideos":50},{"stream":null,"onlineViewers":{"max":"2 528","middle":null,"inDays":"за 14 д."},"id":"195675197","name":"steel","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/0439cff8-52a5-41c8-ba2d-de5e2c408558-profile_image-300x300.png","followers":{"actual":"112 142","diff":"+372","inDays":"за 7 д."},"views":{"actual":"3 924 531","diff":"+299 135","inDays":"за 26 д."},"isClosed":false,"totalVideos":53},{"stream":null,"onlineViewers":{"max":"2 164","middle":null,"inDays":"за 13 д."},"id":"32184566","name":"rxnexus","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/904ea508-22b6-4678-9f89-17910ede4fd6-profile_image-300x300.jpeg","followers":{"actual":"266 511","diff":"-31","inDays":"за 7 д."},"views":{"actual":"40 281 095","diff":"+272 595","inDays":"за 26 д."},"isClosed":false,"totalVideos":3},{"stream":null,"onlineViewers":{"max":"16 455","middle":"4 947","inDays":"за 13 д."},"id":"188890121","name":"Dmitry_Lixxx","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/02141c8a-a457-4fe7-bfcb-5e0aeb5919d1-profile_image-300x300.png","followers":{"actual":"463 889","diff":"+7 504","inDays":"за 7 д."},"views":{"actual":"14 183 008","diff":"+1 522 606","inDays":"за 26 д."},"isClosed":false,"totalVideos":69},{"stream":{"viewers":"968"},"onlineViewers":{"max":"2 523","middle":"1 156","inDays":"за 13 д."},"id":"95793204","name":"GN_GG","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/97535086-e449-48b3-8b7c-03956b1eb697-profile_image-300x300.png","followers":{"actual":"99 936","diff":"-102","inDays":"за 7 д."},"views":{"actual":"10 105 956","diff":"+148 136","inDays":"за 26 д."},"isClosed":false,"totalVideos":1},{"stream":null,"onlineViewers":{"max":"3 765","middle":"1 563","inDays":"за 13 д."},"id":"51435464","name":"A1taOda","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/a1taoda-profile_image-6f6d48127dd91d6e-300x300.jpeg","followers":{"actual":"565 422","diff":"+330","inDays":"за 7 д."},"views":{"actual":"58 158 687","diff":"+752 744","inDays":"за 26 д."},"isClosed":false,"totalVideos":1},{"stream":null,"onlineViewers":{"max":"196","middle":"101","inDays":"за 14 д."},"id":"40974672","name":"NekrPain","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/71b5cd7d-fd0f-4db6-8526-49b43e87777f-profile_image-300x300.png","followers":{"actual":"8 570","diff":"-22","inDays":"за 7 д."},"views":{"actual":"476 299","diff":"+10 378","inDays":"за 26 д."},"isClosed":false,"totalVideos":38},
    {"stream":null,"onlineViewers":{"max":"35 726","middle":null,"inDays":"за 14 д."},"id":112619759,"isClosed":true,"totalVideos":0,"name":"modestal","logo":null,"views":{"lastValue":"20 909 227","date":"29.11.2020"},"followers":{"lastValue":"384 929","date":"29.11.2020"}},
    {"stream":{"viewers":"742"},"onlineViewers":{"max":"913","middle":"274","inDays":"за 13 д."},"id":"63828424","name":"AIMLUL","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/bf433a0e-1edf-483a-8e08-dc42580bbc0b-profile_image-300x300.png","followers":{"actual":"57 285","diff":"-60","inDays":"за 7 д."},"views":{"actual":"3 908 392","diff":"+67 666","inDays":"за 26 д."},"isClosed":false,"totalVideos":2},{"stream":null,"onlineViewers":{"max":"3 344","middle":"1 105","inDays":"за 14 д."},"id":"36948149","name":"TaeRss","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/taerss-profile_image-109c36e6588d742d-300x300.jpeg","followers":{"actual":"111 002","diff":"+143","inDays":"за 7 д."},"views":{"actual":"17 368 489","diff":"+647 705","inDays":"за 26 д."},"isClosed":false,"totalVideos":25},{"stream":null,"onlineViewers":{"max":"3 332","middle":"1 383","inDays":"за 13 д."},"id":"118263259","name":"CeMka","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/cemka-profile_image-38e81de032c2f9aa-300x300.png","followers":{"actual":"98 615","diff":"+538","inDays":"за 7 д."},"views":{"actual":"16 396 230","diff":"+1 084 342","inDays":"за 26 д."},"isClosed":false,"totalVideos":43},{"stream":null,"onlineViewers":{"max":"3 229","middle":null,"inDays":"за 14 д."},"id":"116780430","name":"Spt083","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/7136d4b3-3295-4f0f-b119-c2d6729173f1-profile_image-300x300.png","followers":{"actual":"231 918","diff":"+4 834","inDays":"за 7 д."},"views":{"actual":"8 704 113","diff":"+288 120","inDays":"за 26 д."},"isClosed":false,"totalVideos":82},{"stream":null,"onlineViewers":{"max":"-","middle":"-","inDays":null},"id":"39176452","name":"XBOCT","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/xboct-profile_image-eed01158eb730339-300x300.jpeg","followers":{"actual":"316 837","diff":"-102","inDays":"за 7 д."},"views":{"actual":"18 093 668","diff":"+2 659","inDays":"за 26 д."},"isClosed":false,"totalVideos":38},{"stream":null,"onlineViewers":{"max":"3 590","middle":"1 898","inDays":"за 11 д."},"id":"265940345","name":"TpaBoMaH","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/509c81ae-7dad-4764-b0f3-e810c3f0bafc-profile_image-300x300.png","followers":{"actual":"170 674","diff":"+1 013","inDays":"за 7 д."},"views":{"actual":"11 585 789","diff":"+548 250","inDays":"за 26 д."},"isClosed":false,"totalVideos":172},{"stream":null,"onlineViewers":{"max":"-","middle":"-","inDays":null},"id":"451634552","name":"egorkreed","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/e01af657-7453-487b-89e8-00e54b241787-profile_image-300x300.png","followers":{"actual":"439 110","diff":"+675","inDays":"за 7 д."},"views":{"actual":"5 658 726","diff":"+22 588","inDays":"за 26 д."},"isClosed":false,"totalVideos":4},{"stream":null,"onlineViewers":{"max":"1 180","middle":null,"inDays":"за 14 д."},"id":"68147611","name":"ksun41k","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/7d9c0f3e-aee7-4738-9826-435f41903503-profile_image-300x300.png","followers":{"actual":"35 260","diff":"+698","inDays":"за 7 д."},"views":{"actual":"3 209 854","diff":"+103 186","inDays":"за 26 д."},"isClosed":false,"totalVideos":27},{"stream":null,"onlineViewers":{"max":"2 315","middle":"979","inDays":"за 14 д."},"id":"62651386","name":"GeneraL_HS_","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/76442814-883b-490e-a2d2-04b277b04d67-profile_image-300x300.png","followers":{"actual":"56 054","diff":"+376","inDays":"за 7 д."},"views":{"actual":"7 086 803","diff":"+795 693","inDays":"за 26 д."},"isClosed":false,"totalVideos":5},{"stream":null,"onlineViewers":{"max":"4 845","middle":"2 585","inDays":"за 14 д."},"id":"230768385","name":"follentass","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/38bfaa2b-b602-42f3-ad81-7934557529f0-profile_image-300x300.png","followers":{"actual":"161 759","diff":"+895","inDays":"за 7 д."},"views":{"actual":"7 479 925","diff":"+395 274","inDays":"за 26 д."},"isClosed":false,"totalVideos":57},{"stream":null,"onlineViewers":{"max":"-","middle":"-","inDays":null},"id":"218598381","name":"SOSEDATEL","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/262fbd6f-4ac7-4d53-ad60-dc4368928462-profile_image-300x300.png","followers":{"actual":"15 393","diff":"-51","inDays":"за 7 д."},"views":{"actual":"333 704","diff":"+408","inDays":"за 26 д."},"isClosed":false,"totalVideos":12},{"stream":null,"onlineViewers":{"max":"-","middle":"-","inDays":null},"id":"593756357","name":"russianminecrafttours","logo":"https://static-cdn.jtvnw.net/user-default-pictures-uv/ebe4cd89-b4f4-4cd9-adac-2f30151b4209-profile_image-300x300.png","followers":{"actual":"19","diff":0,"inDays":6},"views":{"actual":"9 282","diff":"+293","inDays":"за 6 д."},"isClosed":false,"totalVideos":62}
];

const Dashboard = () => {
    const [streamers, setStreamers] = useState([]);
    const [loading, setLoading] = useState(false);

    //delete
    let testList = () => {
        console.log('list', list);
        setTimeout(() => {
            setStreamers(list);
            setLoading(false);
        }, 1500);
    };

    useEffect(() => {
        setLoading(true);
        //delete
        let nowURL = new URL(window.location.href);
        if (nowURL.hostname === 'localhost') {
            console.log ('на localhost');
            testList();
        } else {
            sendRequest('GET', 'https://stat.metacorp.gg/api/streamers')
            .then(dataArr => {
                setStreamers(dataArr);
                setLoading(false);
            });
        };
    }, [])

    return (
        <StreamersContext.Provider value={{ setStreamers }}>
            <div className="block wideBlock">
                <SearchChannel />
                {loading && <Preloader />}
                {streamers.length !== 0 && (
                    <div className="mainTable">
                        <DashboardTable streamers={splitInto2.getFirstPart(streamers)} border={"border-right"} />
                        <DashboardTable streamers={splitInto2.getSecondPart(streamers)} border={"border-left"} />
                    </div>
                )}
            </div>
        </StreamersContext.Provider>
    );
};

export default Dashboard;