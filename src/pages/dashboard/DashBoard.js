import React, { useState, useEffect } from 'react';
import './dashboard.css';
import DashboardTable from 'components/table/DashboardTable';
import sendRequest from 'js/sendRequest';
// import getList from 'js/getList';
import Preloader from 'components/preloader/Preloader';
import SearchChannel from 'components/searchChannel/SearchChannel';
import StreamersContext from 'context/streamersContext';
import splitInto2 from 'js/splitInto2';
// import splitInto3 from 'js/splitInto3';

let list = [
    {"stream":null,"onlineViewers":{"max":"-","middle":"-","inDays":null},"id":"46947742","name":"RIKKIDI","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/46993a9e-557f-4b6b-9703-70ce9338110c-profile_image-300x300.jpg","followers":{"actual":"15 351","diff":"+6","inDays":"за 7 д."},"views":{"actual":"331 526","diff":"+852","inDays":"за 19 д."},"totalVideos":2},{"stream":null,"onlineViewers":{"max":"1 110","middle":"445","inDays":"за 6 д."},"id":"32536070","name":"y0nd","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/2ceffe1a-95cd-4928-aa90-d429346ce70c-profile_image-300x300.png","followers":{"actual":"175 252","diff":"+417","inDays":"за 7 д."},"views":{"actual":"14 598 975","diff":"+66 018","inDays":"за 19 д."},"totalVideos":42},{"stream":null,"onlineViewers":{"max":"1 073","middle":"538","inDays":"за 6 д."},"id":"63813769","name":"pashadizel","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/4012c5bd-c041-4a66-8da6-99135067f9cd-profile_image-300x300.jpeg","followers":{"actual":"92 779","diff":"+41","inDays":"за 7 д."},"views":{"actual":"5 309 854","diff":"+44 759","inDays":"за 19 д."},"totalVideos":27},{"stream":null,"onlineViewers":{"max":"99","middle":"50","inDays":"за 6 д."},"id":"148602448","name":"MissAlina23","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/eb65669c-cad4-4648-8fc7-af8089887136-profile_image-300x300.png","followers":{"actual":"30 788","diff":"+73","inDays":"за 7 д."},"views":{"actual":"1 086 718","diff":"+23 913","inDays":"за 19 д."},"totalVideos":0},{"stream":null,"onlineViewers":{"max":"4 651","middle":"1 068","inDays":"за 6 д."},"id":"44442348","name":"finargot","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/7c89248e-91af-41a1-8209-232343bc0e74-profile_image-300x300.jpg","followers":{"actual":"109 883","diff":"+5 210","inDays":"за 7 д."},"views":{"actual":"3 866 126","diff":"+509 520","inDays":"за 19 д."},"totalVideos":223},{"stream":null,"onlineViewers":{"max":"11 608","middle":"6 853","inDays":"за 6 д."},"totalVideos":0,"id":"68950614","name":"ybicanoooobov","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/ybicanoooobov-profile_image-841fca9b492bd5d5-300x300.jpeg","followers":{"actual":"549 595","diff":"+2 675","inDays":"за 7 д."},"views":{"actual":"63 498 605","diff":"+668 097","inDays":"за 19 д."}},{"stream":null,"onlineViewers":{"max":"14 338","middle":"9 848","inDays":"за 6 д."},"id":"40488774","name":"Stray228","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/stray228-profile_image-ceb0393a88eb8286-300x300.jpeg","followers":{"actual":"831 859","diff":"+6 540","inDays":"за 7 д."},"views":{"actual":"86 448 528","diff":"+2 005 450","inDays":"за 19 д."},"totalVideos":0},{"stream":{"viewers":"1 795"},"onlineViewers":{"max":"2 460","middle":"1 454","inDays":"за 6 д."},"id":"71558231","name":"qSnake","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/7d5a4932-be42-481c-a47a-4136404f2c54-profile_image-300x300.png","followers":{"actual":"210 648","diff":"+933","inDays":"за 7 д."},"views":{"actual":"27 746 109","diff":"+257 741","inDays":"за 19 д."},"totalVideos":90},{"stream":null,"onlineViewers":{"max":"1 563","middle":"894","inDays":"за 6 д."},"id":"136398715","name":"Insize","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/41730834-e1f7-4c62-8e29-af9d2a81257f-profile_image-300x300.png","followers":{"actual":"44 454","diff":"+216","inDays":"за 7 д."},"views":{"actual":"4 798 838","diff":"+91 146","inDays":"за 19 д."},"totalVideos":32},{"stream":null,"onlineViewers":{"max":"26 958","middle":"17 314","inDays":"за 6 д."},"id":"81623587","name":"GENSYXA","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/4c9fd41e-bea3-4df7-b740-2d36216a555c-profile_image-300x300.jpg","followers":{"actual":"474 216","diff":"+10 813","inDays":"за 7 д."},"views":{"actual":"16 421 165","diff":"+1 125 524","inDays":"за 19 д."},"totalVideos":45},{"stream":null,"onlineViewers":{"max":"1 101","middle":"362","inDays":"за 6 д."},"id":"118970121","name":"Denly","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/b3208605-3e0d-40a6-8bed-1e2f9d17303e-profile_image-300x300.png","followers":{"actual":"191 173","diff":"-870","inDays":"за 7 д."},"views":{"actual":"9 044 756","diff":"+406 216","inDays":"за 19 д."},"totalVideos":7},{"stream":null,"onlineViewers":{"max":"119 019","middle":"46 175","inDays":"за 5 д."},"id":"86277097","name":"buster","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/96d66837-22f0-4393-89c5-2e5c2408485b-profile_image-300x300.png","followers":{"actual":"1 411 918","diff":"+28 061","inDays":"за 7 д."},"views":{"actual":"53 564 630","diff":"+4 087 188","inDays":"за 19 д."},"totalVideos":50},{"stream":null,"onlineViewers":{"max":"2 528","middle":null,"inDays":"за 6 д."},"id":"195675197","name":"steel","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/0439cff8-52a5-41c8-ba2d-de5e2c408558-profile_image-300x300.png","followers":{"actual":"111 770","diff":"+687","inDays":"за 7 д."},"views":{"actual":"3 853 658","diff":"+228 262","inDays":"за 19 д."},"totalVideos":55},{"stream":{"viewers":"701"},"onlineViewers":{"max":"2 164","middle":null,"inDays":"за 6 д."},"id":"32184566","name":"rxnexus","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/904ea508-22b6-4678-9f89-17910ede4fd6-profile_image-300x300.jpeg","followers":{"actual":"266 542","diff":"+67","inDays":"за 7 д."},"views":{"actual":"40 219 794","diff":"+211 294","inDays":"за 19 д."},"totalVideos":2},{"stream":null,"onlineViewers":{"max":"7 444","middle":"3 985","inDays":"за 6 д."},"id":"188890121","name":"Dmitry_Lixxx","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/02141c8a-a457-4fe7-bfcb-5e0aeb5919d1-profile_image-300x300.png","followers":{"actual":"456 385","diff":"+1 549","inDays":"за 7 д."},"views":{"actual":"13 676 661","diff":"+1 016 259","inDays":"за 19 д."},"totalVideos":66},{"stream":null,"onlineViewers":{"max":"2 523","middle":"1 413","inDays":"за 6 д."},"id":"95793204","name":"GN_GG","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/97535086-e449-48b3-8b7c-03956b1eb697-profile_image-300x300.png","followers":{"actual":"100 038","diff":"-35","inDays":"за 7 д."},"views":{"actual":"10 093 988","diff":"+136 168","inDays":"за 19 д."},"totalVideos":1},{"stream":null,"onlineViewers":{"max":"3 765","middle":"1 713","inDays":"за 6 д."},"id":"51435464","name":"A1taOda","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/a1taoda-profile_image-6f6d48127dd91d6e-300x300.jpeg","followers":{"actual":"565 092","diff":"+795","inDays":"за 7 д."},"views":{"actual":"58 008 515","diff":"+602 572","inDays":"за 19 д."},"totalVideos":0},{"stream":null,"onlineViewers":{"max":"196","middle":"101","inDays":"за 6 д."},"id":"40974672","name":"NekrPain","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/71b5cd7d-fd0f-4db6-8526-49b43e87777f-profile_image-300x300.png","followers":{"actual":"8 592","diff":"-15","inDays":"за 7 д."},"views":{"actual":"473 897","diff":"+7 976","inDays":"за 19 д."},"totalVideos":35},{"stream":null,"onlineViewers":{"max":"35 726","middle":"8 487","inDays":"за 6 д."},"id":"112619759","name":"modestal","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/1c49e85f-765d-46cf-afb0-d446a57d3f43-profile_image-300x300.jpeg","followers":{"actual":"382 876","diff":"+2 664","inDays":"за 7 д."},"views":{"actual":"20 631 458","diff":"+900 439","inDays":"за 19 д."},"totalVideos":60},{"stream":null,"onlineViewers":{"max":"913","middle":"406","inDays":"за 5 д."},"id":"63828424","name":"AIMLUL","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/bf433a0e-1edf-483a-8e08-dc42580bbc0b-profile_image-300x300.png","followers":{"actual":"57 345","diff":"+8","inDays":"за 7 д."},"views":{"actual":"3 904 941","diff":"+64 215","inDays":"за 19 д."},"totalVideos":0},{"stream":null,"onlineViewers":{"max":"3 344","middle":"1 460","inDays":"за 6 д."},"id":"36948149","name":"TaeRss","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/taerss-profile_image-109c36e6588d742d-300x300.jpeg","followers":{"actual":"110 859","diff":"+180","inDays":"за 7 д."},"views":{"actual":"17 193 227","diff":"+472 443","inDays":"за 19 д."},"totalVideos":18},{"stream":null,"onlineViewers":{"max":"2 925","middle":"1 654","inDays":"за 6 д."},"id":"118263259","name":"CeMka","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/cemka-profile_image-38e81de032c2f9aa-300x300.png","followers":{"actual":"98 077","diff":"+202","inDays":"за 7 д."},"views":{"actual":"16 119 035","diff":"+807 147","inDays":"за 19 д."},"totalVideos":35},{"stream":null,"onlineViewers":{"max":"3 037","middle":"658","inDays":"за 6 д."},"id":"116780430","name":"Spt083","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/7136d4b3-3295-4f0f-b119-c2d6729173f1-profile_image-300x300.png","followers":{"actual":"227 086","diff":"+2 175","inDays":"за 7 д."},"views":{"actual":"8 632 806","diff":"+216 813","inDays":"за 19 д."},"totalVideos":79},{"stream":null,"onlineViewers":{"max":"-","middle":"-","inDays":null},"id":"39176452","name":"XBOCT","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/xboct-profile_image-eed01158eb730339-300x300.jpeg","followers":{"actual":"316 939","diff":"-126","inDays":"за 7 д."},"views":{"actual":"18 092 949","diff":"+1 940","inDays":"за 19 д."},"totalVideos":40},{"stream":null,"onlineViewers":{"max":"3 282","middle":"1 622","inDays":"за 3 д."},"id":"265940345","name":"TpaBoMaH","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/509c81ae-7dad-4764-b0f3-e810c3f0bafc-profile_image-300x300.png","followers":{"actual":"169 660","diff":"+965","inDays":"за 7 д."},"views":{"actual":"11 432 582","diff":"+395 043","inDays":"за 19 д."},"totalVideos":172},{"stream":null,"onlineViewers":{"max":"-","middle":"-","inDays":null},"id":"451634552","name":"egorkreed","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/e01af657-7453-487b-89e8-00e54b241787-profile_image-300x300.png","followers":{"actual":"438 434","diff":"+1 014","inDays":"за 7 д."},"views":{"actual":"5 652 987","diff":"+16 849","inDays":"за 19 д."},"totalVideos":4},{"stream":null,"onlineViewers":{"max":"1 180","middle":"228","inDays":"за 6 д."},"id":"68147611","name":"ksun41k","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/7d9c0f3e-aee7-4738-9826-435f41903503-profile_image-300x300.png","followers":{"actual":"34 562","diff":"+468","inDays":"за 7 д."},"views":{"actual":"3 170 819","diff":"+64 151","inDays":"за 19 д."},"totalVideos":23},{"stream":null,"onlineViewers":{"max":"2 307","middle":"1 080","inDays":"за 6 д."},"id":"62651386","name":"GeneraL_HS_","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/76442814-883b-490e-a2d2-04b277b04d67-profile_image-300x300.png","followers":{"actual":"55 678","diff":"+712","inDays":"за 7 д."},"views":{"actual":"6 949 525","diff":"+658 415","inDays":"за 19 д."},"totalVideos":6},{"stream":null,"onlineViewers":{"max":"3 880","middle":"2 676","inDays":"за 6 д."},"id":"230768385","name":"follentass","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/38bfaa2b-b602-42f3-ad81-7934557529f0-profile_image-300x300.png","followers":{"actual":"160 864","diff":"+661","inDays":"за 7 д."},"views":{"actual":"7 369 896","diff":"+285 245","inDays":"за 19 д."},"totalVideos":53},{"stream":null,"onlineViewers":{"max":"-","middle":"-","inDays":null},"id":"218598381","name":"SOSEDATEL","logo":"https://static-cdn.jtvnw.net/jtv_user_pictures/262fbd6f-4ac7-4d53-ad60-dc4368928462-profile_image-300x300.png","followers":{"actual":"15 444","diff":"-55","inDays":"за 7 д."},"views":{"actual":"333 610","diff":"+314","inDays":"за 19 д."},"totalVideos":12}
];

const Dashboard = () => {
    const [streamers, setStreamers] = useState([]);
    const [loading, setLoading] = useState(false);

    //delete
    let testList = () => {
        console.log('list', list);
        setTimeout(() => {
            setStreamers(list);
            setLoading(false);
        }, 1500);
    };

    useEffect(() => {
        setLoading(true);
        //delete
        let nowURL = new URL(window.location.href);
        if (nowURL.hostname === 'localhost') {
            console.log ('на localhost');
            testList();
        } else {
            sendRequest('GET', 'https://stat.metacorp.gg/api/streamers')
            .then(dataArr => {
                setStreamers(dataArr);
                setLoading(false);
            });
        };
    }, [])

    return (
        <StreamersContext.Provider value={{ setStreamers }}>
            <div className="block wideBlock">
                <SearchChannel />
                {loading && <Preloader />}
                {streamers.length !== 0 && (
                    <div className="mainTable">
                        <DashboardTable streamers={splitInto2.getFirstPart(streamers)} border={"border-right"} />
                        <DashboardTable streamers={splitInto2.getSecondPart(streamers)} border={"border-left"} />
                    </div>
                )}
            </div>
        </StreamersContext.Provider>
    );
};

export default Dashboard;